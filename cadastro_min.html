<!doctype html><html lang="pt-br"><meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Cadastro ACTECmax (MIN)</title>
<body style="font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:#f7f7f8;color:#0f172a">
  <h2 style="max-width:900px;margin:24px auto 8px">Ficha Cadastral — TESTE MIN</h2>
  <form id="form" method="POST"
        action="https://script.google.com/macros/s/AKfycbzTahtL4J7SBb1MTtOjkS3Kxht77upE0K4c0ipf0vttpCplHkeQcP0db0cDMzeQR-4C/exec"
        enctype="multipart/form-data" target="ok"
        style="max-width:900px;margin:0 auto;background:#fff;padding:16px 20px;border-radius:12px;box-shadow:0 8px 28px rgba(0,0,0,.06)">
    <input type="hidden" name="_marker" value="ACTECMIN">
    <label>Razão Social<br><input name="razao_social" required style="width:100%;padding:10px;border:1px solid #cbd5e1;border-radius:10px"></label><br><br>
    <label>CNPJ<br><input name="cnpj" required style="width:100%;padding:10px;border:1px solid #cbd5e1;border-radius:10px"></label><br><br>
    <label>Contrato Social (PDF/JPG/PNG)<br><input id="file" type="file" accept=".pdf,.jpg,.jpeg,.png" required></label>

    <!-- campos ocultos com o arquivo em base64 -->
    <input type="hidden" name="file1_name" id="file1_name">
    <input type="hidden" name="file1_mime" id="file1_mime">
    <input type="hidden" name="file1_b64"  id="file1_b64">

    <br><br>
    <button type="submit" style="padding:12px 16px;border:0;border-radius:12px;background:#0f172a;color:#fff;font-weight:600">Enviar</button>
  </form>
  <iframe name="ok" style="display:none"></iframe>

  <script>
    // Converte o arquivo selecionado para base64 e só então envia
    (function(){
      const form = document.getElementById('form');
      const inp  = document.getElementById('file');
      form.addEventListener('submit', function(ev){
        const f = inp.files && inp.files[0];
        if(!f){ return; } // sem arquivo, deixa enviar normal (só texto)
        ev.preventDefault();
        const R = new FileReader();
        R.onload = function(){
          const dataUrl = R.result || '';
          const b64 = String(dataUrl).split(',')[1] || ''; // tira o prefixo data:
          document.getElementById('file1_name').value = f.name;
          document.getElementById('file1_mime').value = f.type || 'application/octet-stream';
          document.getElementById('file1_b64').value  = b64;
          // limpa o input de arquivo para evitar multipart duplicado
          inp.value = '';
          form.submit(); // envio nativo (POST) para o iframe
        };
        R.readAsDataURL(f);
      });
    })();
  </script>
</body></html>
